/* ==========================================================================
   UTILITIES - Helpers, Touch Targets, Typography, Chat, Misc
   ========================================================================== */

/* --------------------------------------------------------------------------
   SKIP LINK (Accessibility)
   -------------------------------------------------------------------------- */

.skip-link {
  @apply sr-only focus:not-sr-only focus:fixed focus:top-4 focus:left-1/2 focus:-translate-x-1/2 focus:z-[9999] focus:px-4 focus:py-2 focus:bg-violet-600 focus:text-white focus:rounded-lg focus:outline-none;
}

/* --------------------------------------------------------------------------
   CHAT
   -------------------------------------------------------------------------- */

#chat-container a,
#chat-container a:active,
#chat-container a:focus,
#chat-container a:focus-visible,
#chat-container button,
#chat-container button:active,
#chat-container button:focus,
#chat-container button:focus-visible {
  -webkit-tap-highlight-color: transparent;
  outline: none !important;
  box-shadow: none !important;
}

#chat-container a {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

#chat-container .badge-error {
  background-color: #dc2626 !important;
  border-color: #dc2626 !important;
  color: #ffffff !important;
}

#chat-container .text-error {
  color: #f87171 !important;
}

#chat-container .bg-error {
  background-color: #dc2626 !important;
  color: #ffffff !important;
}

#chat-container .bg-error\/20 {
  background-color: rgba(220, 38, 38, 0.2) !important;
}

#chat-container .border-error {
  border-color: #dc2626 !important;
}

#chat-container .btn-error {
  background:
    linear-gradient(135deg, rgba(220, 38, 38, 0.24), rgba(220, 38, 38, 0.1) 55%, rgba(0, 0, 0, 0) 100%),
    linear-gradient(135deg, oklch(var(--b1) / 0.96), oklch(var(--b2) / 0.9)) !important;
  border-color: rgba(220, 38, 38, 0.52) !important;
  color: rgba(254, 226, 226, 0.98) !important;
}

#chat-container .btn-error:hover {
  background:
    linear-gradient(135deg, rgba(220, 38, 38, 0.32), rgba(220, 38, 38, 0.14) 55%, rgba(0, 0, 0, 0) 100%),
    linear-gradient(135deg, oklch(var(--b1) / 0.96), oklch(var(--b2) / 0.9)) !important;
  border-color: rgba(220, 38, 38, 0.64) !important;
}

#chat-container .hover\:text-error:hover {
  color: #fca5a5 !important;
}

#chat-container .hover\:border-error\/50:hover {
  border-color: rgba(220, 38, 38, 0.5) !important;
}

#chat-container .progress-error::-webkit-progress-value {
  background-color: #dc2626 !important;
}

#chat-container .progress-error::-moz-progress-bar {
  background-color: #dc2626 !important;
}


/* --------------------------------------------------------------------------
   TEXT SELECTION
   -------------------------------------------------------------------------- */

.post-content,
.message-content {
  user-select: text;
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
}

.message-selected,
.card.message-selected,
div.message-selected {
  background-color: rgba(124, 58, 237, 0.1) !important;
  border-color: rgba(124, 58, 237, 0.5) !important;
  box-shadow: 0 0 0 1px rgba(124, 58, 237, 0.2) !important;
}

.message-selected:hover,
.card.message-selected:hover,
div.message-selected:hover {
  background-color: rgba(124, 58, 237, 0.15) !important;
  border-color: rgba(124, 58, 237, 0.7) !important;
  box-shadow: 0 0 0 1px rgba(124, 58, 237, 0.3) !important;
}

/* --------------------------------------------------------------------------
   TAG INPUT
   -------------------------------------------------------------------------- */

.tag-input-wrapper {
  position: relative;
}

.tag-input-wrapper .tag {
  animation: fadeIn 0.2s ease-out;
}

.tag-input-wrapper input.text-error {
  color: hsl(var(--er));
  animation: shake 0.3s ease-out;
}

/* --------------------------------------------------------------------------
   MARKDOWN EDITOR
   -------------------------------------------------------------------------- */

#editor-container.flex {
  display: flex;
  gap: 0.5rem;
}

#editor-container.flex #editor-write {
  width: 50%;
}

#editor-container.flex #editor-preview {
  width: 50%;
}

#editor-container.flex textarea {
  border-radius: 0.5rem !important;
  border: 1px solid hsl(var(--b3)) !important;
}

#editor-container.flex #editor-preview > div {
  border-radius: 0.5rem !important;
  border: 1px solid hsl(var(--b3)) !important;
  height: 100%;
}

#preview-content {
  line-height: 1.6;
}

#preview-content h1 { font-size: 1.875rem; font-weight: 700; margin: 1rem 0; }
#preview-content h2 { font-size: 1.5rem; font-weight: 600; margin: 0.75rem 0; }
#preview-content h3 { font-size: 1.25rem; font-weight: 600; margin: 0.5rem 0; }

#preview-content blockquote {
  border-left: 4px solid hsl(var(--p));
  padding-left: 1rem;
  margin: 0.5rem 0;
  font-style: italic;
}

#preview-content pre {
  background: hsl(var(--b2));
  padding: 0.75rem;
  border-radius: 0.375rem;
  overflow-x: auto;
  margin: 0.5rem 0;
}

#preview-content code {
  background: hsl(var(--b2));
  padding: 0.125rem 0.25rem;
  border-radius: 0.25rem;
  font-weight: 500;
}

/* --------------------------------------------------------------------------
   TURNSTILE (Cloudflare)
   -------------------------------------------------------------------------- */

.turnstile-wrapper {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  min-height: 65px;
  margin: 0.5rem auto;
  overflow: hidden;
  position: relative;
  max-width: 100vw;
}

.turnstile-wrapper iframe {
  max-width: 100% !important;
}

@media (min-width: 768px) {
  .turnstile-wrapper .cf-turnstile {
    transform: scale(1.13);
    transform-origin: center;
  }
}

@media (max-width: 767px) {
  .turnstile-wrapper {
    max-width: calc(100vw - 2rem);
  }
  .turnstile-wrapper .cf-turnstile {
    transform: scale(0.9);
    transform-origin: center;
  }
}

@media (max-width: 480px) {
  .turnstile-wrapper {
    max-width: calc(100vw - 2rem);
  }
  .turnstile-wrapper .cf-turnstile {
    transform: scale(0.8);
    transform-origin: center;
  }
}

@media (max-width: 400px) {
  .turnstile-wrapper {
    max-width: calc(100vw - 1.5rem);
  }
  .turnstile-wrapper .cf-turnstile {
    transform: scale(0.7);
    transform-origin: center;
  }
}

@media (max-width: 360px) {
  .turnstile-wrapper {
    max-width: calc(100vw - 1rem);
  }
  .turnstile-wrapper .cf-turnstile {
    transform: scale(0.62);
    transform-origin: center;
  }
}

@media (max-width: 320px) {
  .turnstile-wrapper {
    max-width: calc(100vw - 1rem);
  }
  .turnstile-wrapper .cf-turnstile {
    transform: scale(0.55);
    transform-origin: center;
  }
}

/* --------------------------------------------------------------------------
   CUSTOM EMOJI
   -------------------------------------------------------------------------- */

.custom-emoji {
  height: 1.5em;
  width: auto;
  vertical-align: -0.3em;
  display: inline-block;
  object-fit: contain;
  margin: 0 0.1em;
}

.custom-emoji.inline-emoji {
  height: 1.2em;
  vertical-align: -0.2em;
}

.message-content .custom-emoji {
  height: 1.5em;
}

.large-emoji .custom-emoji {
  height: 2em;
}

/* --------------------------------------------------------------------------
   LAYOUT STABILITY
   -------------------------------------------------------------------------- */

.post-actions-container {
  contain: layout;
}

/* --------------------------------------------------------------------------
   MOBILE RESPONSIVE
   -------------------------------------------------------------------------- */

@media (max-width: 640px) {
  iframe {
    max-width: 100% !important;
  }

  #profile-container {
    overflow-x: hidden;
  }

  h1, h2, h3 {
    word-wrap: break-word;
    overflow-wrap: break-word;
    hyphens: auto;
  }

  .username-effect-glow,
  .username-effect-neon {
    --glow-intensity: calc(var(--glow-intensity, 10px) * 0.7);
  }

  .card-body {
    overflow-x: hidden;
  }

  .min-w-0 {
    overflow: hidden;
  }
}


/* --------------------------------------------------------------------------
   GLASS/OPACITY UTILITIES
   -------------------------------------------------------------------------- */

/* Glass background variants */
.bg-glass {
  background-color: oklch(var(--b1) / 0.8) !important;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.bg-glass-light {
  background-color: oklch(var(--b1) / 0.9) !important;
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

.bg-glass-heavy {
  background-color: oklch(var(--b1) / 0.7) !important;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

/* Base-200 glass variant */
.bg-base-200-glass {
  background-color: oklch(var(--b2) / 0.8) !important;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

/* Colored glass variants matching home page */
.bg-purple-glass {
  background-color: rgba(88, 28, 135, 0.1) !important;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.bg-red-glass {
  background-color: rgba(127, 29, 29, 0.1) !important;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.bg-orange-glass {
  background-color: rgba(124, 45, 18, 0.1) !important;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}
